/* #######################################
 * ## Reglas Yara para DUMPS de memoria ##
 * ##      Powered by @NaxoneZ          ##
 * #######################################
 */

rule PandaBankerInMemory
{
	strings:
		$string1 = "url_plugin_vnc_backserver"
		$string2 = "url_webinjects"
		$string3 = "url_config"
		$string4 = "check_config"

	condition:
		all of them

}
rule ZloaderInjectionInMemory
{
	strings:
		$string1 = "set_url"
		$string2 = "data_before"
		$string3 = "data_inject"
		$string4 = "data_after"
		$string5 = "data_end"
		$string6 = "webfakes"
		$string7 = "webfilters"

	condition:
		all of them

}
rule DridexInjectionInMemory
{
	strings:
		$string1 = "^https://"
		$string2 = "_redirect"

	condition:
		$string1 and $string2

}

rule Tinba_or_RamnitInjectionInMemory
{

	strings:
		$string1 = "set_url"
		$string2 = "data_inject"
		$string3 = "webfilters"
	condition:
		($string1 and $string2) and not ($string3)
}

rule ZeusInjectionInMemory
{

	strings:
		$string1 = "set_url"
		$string2 = "data_inject"
		$string3 = "webfilters"
		$string4 = "webfakes"
	
	condition:
		($string1 and $string2 and $string3) and not $string4
}

rule ShiotobInMemory
{
        strings:
                $string1 = "/gate_urlzone/"
                $string2 = "%BOTID%"
                $string3 = "%BOTNET%"

        condition:
                $string1 and $string2 and $string3
}

rule DyreInjectionInMemory
{
	strings:
		$string1 = "<sinj>"
		$string2 = "<dinj>"
		$string3 = "<dpost>"
		$string4 = "<nh>"
		$string5 = "<srv>"
		$string6 = "<sm>"

	condition:
		$string1 and $string2 and $string3 and $string4 and $string5 and $string6

}

rule TrickBotInjectionInMemory
{
	strings:
		$string1 = "<sinj>"
		$string2 = "<dinj>"
		$string3 = "<dpost>"
		$string4 = "<nh>"
		$string5 = "<srv>"
		$string6 = "<sm>"

	condition:
		$string1 and $string2 and $string3 and not ($string4 or $string5 or $string6)

}
